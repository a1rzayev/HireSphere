@{
    ViewData["Title"] = "Admin Panel";
}

<div class="text-center">
    <h1 class="display-4">Admin Panel</h1>
    <p>Welcome to the HireSphere Administration Panel</p>
</div>

@section Scripts {
    <script>
        // Simple token persistence check - only copy from session to localStorage if needed
        document.addEventListener('DOMContentLoaded', function() {
            const sessionAccessToken = '@Context.Session.GetString("AccessToken")';
            const sessionRefreshToken = '@Context.Session.GetString("RefreshToken")';
            
            // Only set localStorage if session has tokens and localStorage is empty
            if (sessionAccessToken && sessionRefreshToken) {
                const storedAccessToken = localStorage.getItem('accessToken');
                const storedRefreshToken = localStorage.getItem('refreshToken');
                
                if (!storedAccessToken || !storedRefreshToken) {
                    localStorage.setItem('accessToken', sessionAccessToken);
                    localStorage.setItem('refreshToken', sessionRefreshToken);
                    console.log('Tokens copied from session to localStorage');
                }
            }
            
            // Update navigation visibility
            updateNavigationVisibility();
        });
        
        function updateNavigationVisibility() {
            const loginNavItem = document.getElementById('login-nav-item');
            const logoutNavItem = document.getElementById('logout-nav-item');
            const adminNavItems = document.getElementById('admin-nav-items');
            
            const hasTokens = localStorage.getItem('accessToken') && localStorage.getItem('refreshToken');
            
            if (hasTokens) {
                if (loginNavItem) loginNavItem.style.display = 'none';
                if (logoutNavItem) logoutNavItem.style.display = 'block';
                if (adminNavItems) adminNavItems.style.display = 'block';
            } else {
                if (loginNavItem) loginNavItem.style.display = 'block';
                if (logoutNavItem) logoutNavItem.style.display = 'none';
                if (adminNavItems) adminNavItems.style.display = 'none';
            }
        }
    </script>
}
